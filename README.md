# AegisOverhaul

Windows PC のメンテナンスとネットワーク最適化をまとめて実行するバッチスクリプトです。現在の実装は `AegisOverhaul.bat` の単体構成で、アプリ更新・キャッシュ削除・サービス制御・レジストリ最適化・ネットワーク調整などを包括的に行います。誤操作を防ぐため、管理者権限の有無を確認してから処理を開始します。 

## 主な機能

- **管理者権限チェックとエクスプローラーの一時停止**
  - 管理者権限がない場合は停止し、権限があれば `explorer.exe` を一時停止して作業を行います。
- **アプリケーション更新**
  - `winget upgrade --all` によるアプリ更新と Microsoft Store アプリの再登録を実行します。
- **サービス停止**
  - `bits`、`wuauserv` などのサービスを停止します。
- **ファイル／キャッシュクリーンアップ**
  - Discord、Microsoft、Windows 系キャッシュや一時ファイル、ブラウザキャッシュを対象に削除します。
  - 一部の不要ディレクトリ（`SoftwareDistribution`、`Prefetch` など）を削除します。
  - ゴミ箱を空にします。
- **Windows Defender 更新**
  - 定義ファイルの更新を行います。
- **システム最適化**
  - UI 視認性や応答速度のためのレジストリ調整、電源プランの初期化、休止状態の無効化などを行います。
  - `MMAgent` 設定（メモリ圧縮、ページ結合など）を調整します。
- **オーディオ最適化**
  - USB 選択的サスペンド無効化や MMCSS 優先度設定などを実施します。
- **GPU 割り込み分散の調整**
  - NVIDIA GPU の `MessageNumberLimit` を削除して割り込み分散を最適化します。
- **ネットワーク最適化**
  - DNS キャッシュや Winsock をリセットし、TCP 設定を調整します。
- **その他**
  - イベントログ削除、Microsoft Store キャッシュ削除、エクスプローラー再起動などを行います。

## 動作環境

- Windows 10 / 11
- 管理者権限での実行が必須
- `winget` と `PowerShell` が利用可能であること

## 使い方

1. `AegisOverhaul.bat` を右クリックし、「**管理者として実行**」を選択します。
2. 画面の指示に従い処理が完了するまで待機します。
3. 処理完了後に必要であれば再起動してください。

## 注意事項

- **削除やリセット処理が多く含まれるため、必ずバックアップを取ってから実行してください。**
- `SoftwareDistribution` や `Prefetch`、ユーザープロファイル配下のディレクトリ削除など、環境によっては影響が出る可能性があります。
- ネットワークリセット、レジストリ変更、電源設定の変更が行われます。職場や共有 PC などでは慎重に使用してください。
- 実行により一部のアプリ設定やキャッシュが失われる可能性があります。

## カスタマイズ

- 実行したくない処理がある場合は `AegisOverhaul.bat` 内の該当行をコメントアウトしてください。
- `CleanDirectory` サブルーチンで削除対象のパスを追加／削除できます。

## ライセンス

- `LICENSE` を参照してください。

## 作者

- 名前: ゆろち
- 連絡先: https://github.com/1llum1n4t1s
